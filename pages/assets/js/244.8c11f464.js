(window.webpackJsonp=window.webpackJsonp||[]).push([[244],{721:function(a,s,e){"use strict";e.r(s);var t=e(17),n=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"lru-cache"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lru-cache"}},[a._v("#")]),a._v(" lru-cache")]),a._v(" "),e("p",[a._v("为了优化程序性能，我们常常需要奖数据缓存起来，根据实际情况，我们可以将数据存储到磁盘、数据库、redis等。")]),a._v(" "),e("p",[a._v("但是有时候要缓存的数据量非常小，或者项目规模非常小，也许就是一个工具脚本，使用redis等外部数据库，还得做依赖部署。而直接将数据保存在程序变量中，最经济、快捷。但是这样就会带来一些其他问题，比如缓存更新、缓存过期等。")]),a._v(" "),e("h3",{attrs:{id:"lru-cache介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lru-cache介绍"}},[a._v("#")]),a._v(" lru-cache介绍")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[a._v("名称")]),a._v(" "),e("th",{staticStyle:{"text-align":"left"}},[a._v("地址")])])]),a._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[a._v("GitHub仓库")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/isaacs/node-lru-cache",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/isaacs/node-lru-cache"),e("OutboundLink")],1)])])])]),a._v(" "),e("p",[a._v("lru-cache 用于在内存中管理缓存数据，并且支持LRU算法。可以让程序不依赖任何外部数据库实现缓存管理。")]),a._v(" "),e("ul",[e("li",[a._v("LRU算法：尽量保留最近使用过的项")]),a._v(" "),e("li",[a._v("可指定缓存大小")]),a._v(" "),e("li",[a._v("可指定缓存项过期时间")])]),a._v(" "),e("blockquote",[e("p",[a._v("LruCache的缓存算法\nLruCache采用的缓存算法为LRU（Least Recently Used），最近最少使用算法。核心思想是当缓存满时，会优先淘汰那些近期最少使用的缓存对象。")])]),a._v(" "),e("h2",{attrs:{id:"基本使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基本使用"}},[a._v("#")]),a._v(" 基本使用")]),a._v(" "),e("h3",{attrs:{id:"安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("npm install lru-cache --save\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h3",{attrs:{id:"使用示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[a._v("#")]),a._v(" 使用示例")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('var lru = require("lru-cache");\nvar options = {\n    max : 500,               //最大条数\n    maxAge : 1000 * 60 * 60  //缓存时间 1000 * 60 * 60 = 1小时\n}\nvar cache = lru(options);\n\n//设置指定key缓存\ncache.set("key", "value")\n\n//获取指定key缓存\ncache.get("key") // "value"\n\n//清空所有缓存\ncache.reset()\n')])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br")])]),e("h3",{attrs:{id:"api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[a._v("#")]),a._v(" API")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('var lru = require("lru-cache");\nvar cache = lru();\n# 设置缓存\ncache.set(key, value[, maxAge])\n\n# 获取指定key缓存，更新最近使用\ncache.get(key) => value\n')])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br")])]),e("ul",[e("li",[a._v("使用set或get方法会将该key进行最新使用更新")]),a._v(" "),e("li",[a._v("maxAge是一个可以选参数，传入将覆盖设置的值")]),a._v(" "),e("li",[a._v("get如果访问的key不存在，则返回undefined")])]),a._v(" "),e("p",[a._v("获取")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 获取缓存，但是不进行最新使用更新\ncache.peek(key)\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("p",[a._v("删除")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 从缓存中删除key。\ncache.del(key)\n\n# 清空所有缓存\ncache.reset();\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])]),e("p",[a._v("检测某个key是否在缓存中")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cache.has(key)\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("长度")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 返回缓存中对象的总长度\ncache.length\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("p",[a._v("其他API")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 返回缓存中的键数组。\nkeys()\n\n# 返回缓存中的值数组。\nvalues()\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])]),e("h3",{attrs:{id:"注意事项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[a._v("#")]),a._v(" 注意事项")]),a._v(" "),e("p",[a._v("虽然，lru-cache 使用非常方便，但是lru-cache的缓存数据保存在当前进程内存内，这就决定了依赖lru-cache的项目是有状态的程序，这样就不能够分布式部署多实例负载均衡，所以如果系统设计需要多实例运行，那么还是需要使用redis。")])])}),[],!1,null,null,null);s.default=n.exports}}]);