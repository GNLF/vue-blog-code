(window.webpackJsonp=window.webpackJsonp||[]).push([[461],{937:function(a,e,s){"use strict";s.r(e);var t=s(17),n=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"使用分包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用分包"}},[a._v("#")]),a._v(" 使用分包")]),a._v(" "),s("h3",{attrs:{id:"配置方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置方法"}},[a._v("#")]),a._v(" 配置方法")]),a._v(" "),s("p",[a._v("假设支持分包的小程序目录结构如下：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("├── app.js\n├── app.json\n├── app.wxss\n├── packageA\n│   └── pages\n│       ├── cat\n│       └── dog\n├── packageB\n│   └── pages\n│       ├── apple\n│       └── banana\n├── pages\n│   ├── index\n│   └── logs\n└── utils\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br")])]),s("p",[a._v("开发者通过在 app.json "),s("code",[a._v("subpackages")]),a._v(" 字段声明项目分包结构：")]),a._v(" "),s("blockquote",[s("p",[a._v("写成 subPackages 也支持。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('{\n  "pages": ["pages/index", "pages/logs"],\n  "subpackages": [\n    {\n      "root": "packageA",\n      "pages": ["pages/cat", "pages/dog"]\n    },\n    {\n      "root": "packageB",\n      "name": "pack2",\n      "pages": ["pages/apple", "pages/banana"]\n    }\n  ]\n}\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br")])]),s("p",[s("code",[a._v("subpackages")]),a._v(" 中，每个分包的配置有以下几项：")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("字段")]),a._v(" "),s("th",[a._v("类型")]),a._v(" "),s("th",[a._v("说明")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("root")]),a._v(" "),s("td",[a._v("String")]),a._v(" "),s("td",[a._v("分包根目录")])]),a._v(" "),s("tr",[s("td",[a._v("name")]),a._v(" "),s("td",[a._v("String")]),a._v(" "),s("td",[a._v("分包别名，"),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages/preload.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("分包预下载"),s("OutboundLink")],1),a._v("时可以使用")])]),a._v(" "),s("tr",[s("td",[a._v("pages")]),a._v(" "),s("td",[a._v("StringArray")]),a._v(" "),s("td",[a._v("分包页面路径，相对与分包根目录")])]),a._v(" "),s("tr",[s("td",[a._v("independent")]),a._v(" "),s("td",[a._v("Boolean")]),a._v(" "),s("td",[a._v("分包是否是"),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages/independent.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("独立分包"),s("OutboundLink")],1)])])])]),a._v(" "),s("h3",{attrs:{id:"打包原则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#打包原则"}},[a._v("#")]),a._v(" 打包原则")]),a._v(" "),s("ul",[s("li",[a._v("声明 "),s("code",[a._v("subpackages")]),a._v(" 后，将按 "),s("code",[a._v("subpackages")]),a._v(" 配置路径进行打包，"),s("code",[a._v("subpackages")]),a._v(" 配置路径外的目录将被打包到 app（主包） 中")]),a._v(" "),s("li",[a._v("app（主包）也可以有自己的 pages（即最外层的 pages 字段）")]),a._v(" "),s("li",[s("code",[a._v("subpackage")]),a._v(" 的根目录不能是另外一个 "),s("code",[a._v("subpackage")]),a._v(" 内的子目录")]),a._v(" "),s("li",[s("code",[a._v("tabBar")]),a._v(" 页面必须在 app（主包）内")])]),a._v(" "),s("h3",{attrs:{id:"引用原则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引用原则"}},[a._v("#")]),a._v(" 引用原则")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("packageA")]),a._v(" 无法 require "),s("code",[a._v("packageB")]),a._v(" JS 文件，但可以 require "),s("code",[a._v("app")]),a._v("、自己 package 内的 JS 文件")]),a._v(" "),s("li",[s("code",[a._v("packageA")]),a._v(" 无法 import "),s("code",[a._v("packageB")]),a._v(" 的 template，但可以 require "),s("code",[a._v("app")]),a._v("、自己 package 内的 template")]),a._v(" "),s("li",[s("code",[a._v("packageA")]),a._v(" 无法使用 "),s("code",[a._v("packageB")]),a._v(" 的资源，但可以使用 "),s("code",[a._v("app")]),a._v("、自己 package 内的资源")])]),a._v(" "),s("h3",{attrs:{id:"低版本兼容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#低版本兼容"}},[a._v("#")]),a._v(" 低版本兼容")]),a._v(" "),s("p",[a._v("由微信后台编译来处理旧版本客户端的兼容，后台会编译两份代码包，一份是分包后代码，另外一份是整包的兼容代码。 新客户端用分包，老客户端还是用的整包，完整包会把各个 "),s("code",[a._v("subpackage")]),a._v(" 里面的路径放到 pages 中。")]),a._v(" "),s("h3",{attrs:{id:"示例项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例项目"}},[a._v("#")]),a._v(" 示例项目")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/demo/demo-subpackages.zip",target:"_blank",rel:"noopener noreferrer"}},[a._v("下载 小程序示例（分包加载版）源码"),s("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=n.exports}}]);