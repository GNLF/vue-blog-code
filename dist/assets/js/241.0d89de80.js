(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{714:function(t,e,s){"use strict";s.r(e);var a=s(17),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"log4js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#log4js"}},[t._v("#")]),t._v(" log4js")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://nodei.co/npm/log4js/",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://nodei.co/npm/log4js.png?downloads=true&downloadRank=true&stars=true",alt:"NPM"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("在我们开发项目时，日志是必不可少的一部分，有助于我们排错、数据分析等等。log4js 是一个 nodejs 日志管理工具，可以将日志以各种形式输出到各种渠道。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("地址")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Git地址")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"https://github.com/log4js-node/log4js-node",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/log4js-node/log4js-node"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("NPM地址")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"https://www.npmjs.com/package/log4js",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.npmjs.com/package/log4js"),s("OutboundLink")],1)])])])]),t._v(" "),s("h2",{attrs:{id:"简单使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单使用"}},[t._v("#")]),t._v(" 简单使用")]),t._v(" "),s("p",[t._v("log4js的使用非常简单:")]),t._v(" "),s("ol",[s("li",[t._v("安包(npm install log4js)")]),t._v(" "),s("li",[t._v("创建日志目录(./logs/log_fie/)")]),t._v(" "),s("li",[t._v("添加一个日志输出规则的配置文件(log4js.json) (这个也是有缺省的,但往往缺省配置是不满足使用需求的)")]),t._v(" "),s("li",[t._v("代码中加载log4js,并将配置文件获取到调用一下配置方法(log4js.configure(cfg.json))")]),t._v(" "),s("li",[t._v("写日志log4js.getLogger('log_test').debug(\"随便写日志啦!!!\")")])]),t._v(" "),s("p",[t._v("安装")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm install log4js --save\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("简单使用")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# test.js\nvar log4js = require('log4js');\nvar logger = log4js.getLogger();\nlogger.level = 'debug'; // default level is OFF - which means no logs at all.\nlogger.debug(\"Time\", \"Some debug messages\");\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("运行 "),s("code",[t._v("node test.js")]),t._v("，输出如下：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[2018-09-09T23:29:45.273] [DEBUG] default - Some debug messages\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"log输出格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#log输出格式"}},[t._v("#")]),t._v(" log输出格式")]),t._v(" "),s("p",[t._v("默认情况下，log4js-node的每条log输出格式有如下几个字段：日志产生时间，level，日志分类，日志内容。如果用户没有配置，日志分类字段为“default”。")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("       日志产生时间         level   日志分类        日志内容\n------------------------  ------  -------   -------------------\n[2018-09-10T00:26:42.467] [DEBUG] default - Some debug messages\n[2018-09-10T00:26:42.470] [ERROR] default - Some error messages\n[2018-09-10T00:26:42.470] [WARN]  default - Some warn messages\n[2018-09-10T00:26:42.470] [INFO]  default - Some info messages\n[2018-09-10T00:26:42.470] [TRACE] default - Some trace messages\n[2018-09-10T00:27:21.829] [FATAL] default - Some fatal messages\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("h2",{attrs:{id:"入口【收集日志】"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#入口【收集日志】"}},[t._v("#")]),t._v(" 入口【收集日志】")]),t._v(" "),s("h3",{attrs:{id:"level-分级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#level-分级"}},[t._v("#")]),t._v(" Level(分级)")]),t._v(" "),s("p",[t._v("日志有了分级，log4js 才能更好地为我们展示日志（不同级别的日志在控制台中采用不同的颜色，比如 error 通常是红色的），在生产可以有选择的落盘日志，比如避免一些属于.debug才用的敏感信息被泄露出来。")]),t._v(" "),s("p",[t._v("log4js-node将输出的log分为六个的level，每个level的含义从字面就可以看出， 对于不同的level，log输出到终端时会使用不同的颜色")]),t._v(" "),s("p",[t._v("(trace: 蓝色，debug: 青色， info：绿色，warn：黄色，error：红色， fatal：粉色)。")]),t._v(" "),s("p",[s("img",{attrs:{src:"amWiki/images/node/log4Level.jpeg",alt:"img"}})]),t._v(" "),s("p",[t._v("ALL OFF 这两个等级并不会直接在业务代码中使用。剩下的七个即分别对应 Logger 实例的七个方法，.trace .debug .info ...。也就是说，你在调用这些方法的时候，就相当于为这些日志定了级。因此，之前的 "),s("code",[t._v("[2018-09-09T23:29:45.273] [DEBUG] default - Some debug messages")]),t._v(" 中的 DEBUG 既是这条日志的级别。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("等级")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("适用范围")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("使用原则")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Fatal")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("记录严重错误")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("fatal为系统级别的异常，发生fatal错误，代表服务器整个或者核心功能已经无法工作了，则记录fatal级别的错误日志，最好是同时触发相关的修复和告警工作（比如，给开发和维护人员发送告警邮件）。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Error")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("记录错误日志")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("error为功能或者逻辑级别的严重异常，发生error级别的异常，代表功能或者重要逻辑遇到问题、无法正常工作。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Warn")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("记录警告信息")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("warn用在某些逻辑非常规，发生了一些小故障但是没有大的影响，或者重要数据被修改，或者某些操作需要引起重视。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Info")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("记录一般信息")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("info用于记录一些有用的、关键的信息，一般这些信息出现得不频繁，只是在初始化的地方或者重要操作的地方才记录。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Debug")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("记录调试信息")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("debug用于记录一些调试信息，为了方便查看程序的执行过程和相关数据、了解程序的动态。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("TRACE")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("记录流程跟踪信息")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("这类信息一般用来跟踪一个操作流")])])])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[2018-09-10T00:26:42.467] [DEBUG] default - Some debug messages\n[2018-09-10T00:26:42.470] [ERROR] default - Some error messages\n[2018-09-10T00:26:42.470] [WARN] default - Some warn messages\n[2018-09-10T00:26:42.470] [INFO] default - Some info messages\n[2018-09-10T00:26:42.470] [TRACE] default - Some trace messages\n[2018-09-10T00:27:21.829] [FATAL] default - Some fatal messages\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("h3",{attrs:{id:"category-类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#category-类型"}},[t._v("#")]),t._v(" category(类型)")]),t._v(" "),s("p",[t._v("log4js 还有一个概念就是 category（类型），你可以设置一个 Logger 实例的类型，按照另外一个维度来区分日志：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# file: set-category.js\nvar log4js = require('log4js');\nvar logger = log4js.getLogger('example');\nlogger.level = 'debug';\nlogger.debug(\"Time\", new Date());\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("在通过 "),s("code",[t._v("getLogger")]),t._v(" 获取 Logger 实例时，唯一可以传的一个参数就是 "),s("code",[t._v("loggerCategory")]),t._v("（如'example'）,通过这个参数来指定Logger示例属于哪个类别。")]),t._v(" "),s("p",[t._v("运行")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("node set-catetory.js\n[2018-09-09T23:27:48.685] [DEBUG] example - Time 2018-09-09T15:27:48.685Z\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("那类别有什么用呢，它比级别更为灵活，为日志了提供了第二个区分的维度，例如，你可以为每个文件设置不同的 category。就可以从日志 "),s("code",[t._v("[2018-09-09T23:27:48.685] [DEBUG] set-catetory.js - Time 2018-09-09T15:27:48.685Z")]),t._v(" 看出，这条日志来自于 set-catetory.js 文件。又或者针对不同的 node package 使用不同的 category，这样可以区分日志来源于哪个模块。")]),t._v(" "),s("h2",{attrs:{id:"出口【输出日志】"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#出口【输出日志】"}},[t._v("#")]),t._v(" 出口【输出日志】")]),t._v(" "),s("h3",{attrs:{id:"appender-输出的位置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#appender-输出的位置"}},[t._v("#")]),t._v(" Appender(输出的位置)")]),t._v(" "),s("p",[t._v("现在日志有了级别和类别，解决了日志在入口处定级和分类问题，而在 log4js 中，日志的出口问题（即日志输出到哪里）就由 Appender 来解决。")]),t._v(" "),s("p",[t._v("Appenders将日志序列化为某种形式的输出。可以输出到控制台、文件、发送邮件、通过网络发送输出等等。")]),t._v(" "),s("h4",{attrs:{id:"输出形式类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#输出形式类型"}},[t._v("#")]),t._v(" 输出形式类型")]),t._v(" "),s("p",[t._v("Appenders必须要有一个type来确定输出的形式。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("描述")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("依赖")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("详情")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("console")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("将日志输出到控制台")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/console.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://log4js-node.github.io/log4js-node/console.html"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("file")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("将日志输出到文件,可选文件大小，保留指定数量文件备份。")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/file.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://log4js-node.github.io/log4js-node/file.html"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("DateFile")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("将日志输出指定时间的日志文件中。")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/dateFile.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://log4js-node.github.io/log4js-node/dateFile.html"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("logLevelFilter")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("根据事件级别过滤要记录的日志事件")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/logLevelFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://log4js-node.github.io/log4js-node/logLevelFilter.html"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("smtp")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("将日志事件通过邮件方式发送")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("有")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"https://github.com/log4js-node/smtp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/log4js-node/smtp"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("mailgun")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("使用mailgun服务奖日志消息作为电子邮件发送")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("有")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"https://github.com/log4js-node/mailgun",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/log4js-node/mailgun"),s("OutboundLink")],1)])])])]),t._v(" "),s("h4",{attrs:{id:"console"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#console"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/console.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("console"),s("OutboundLink")],1)]),t._v(" "),s("blockquote",[s("p",[t._v("注意：向控制台写入大量输出会使应用程序占用大量内存。")])]),t._v(" "),s("p",[t._v("将日志输出到控制台")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("必填")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("值")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("type")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("console")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("layout")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("object")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可选")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("（可选，默认为colouredLayout） - 请参阅"),s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/layouts.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("布局"),s("OutboundLink")],1)])])])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("log4js.configure({\n  appenders: { console: { type: 'console' } },\n  categories: { default: { appenders: [ 'console' ], level: 'info' } }\n});\nvar logger = log4js.getLogger();\n\nlogger.\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h4",{attrs:{id:"file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#file"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/file.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("file"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("将日志输出到文件,可选文件大小，保留指定数量文件备份。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("必填")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("值")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("type")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("file")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("filename")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("要写入日志的文件的路径。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("maxLogSize")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("integer")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可选")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("日志文件的最大大小（以字节为单位）。如果未指定，则不会发生日志滚动。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("backups")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("integer")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可选")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("（默认值= 5）日志滚动期间要保留的旧日志文件数。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("layout")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("object")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可选")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("（可选，默认为基础布局） - 请参阅"),s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/layouts.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("布局"),s("OutboundLink")],1)])])])]),t._v(" "),s("p",[t._v("示例:将生成"),s("code",[t._v("all-the-logs.log")]),t._v("包含日志消息的单个日志文件。")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("log4js.configure({\n  appenders: {\n    everything: { type: 'file', filename: 'all-the-logs.log' }\n  },\n  categories: {\n    default: { appenders: [ 'everything' ], level: 'debug' }\n  }\n});\n\nconst logger = log4js.getLogger();\nlogger.debug('I will be logged in all-the-logs.log');\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("p",[t._v("日志滚动（和压缩备份）的示例")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("log4js.configure({\n  appenders: {\n    everything: { type: 'file', filename: 'all-the-logs.log', maxLogSize: 10485760, backups: 3, compress: true }\n  },\n  categories: {\n    default: { appenders: [ 'everything' ], level: 'debug'}\n  }\n});\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("这将生成一个当前日志文件（all-the-logs.log）。当它达到10Mb时，它将被重命名并压缩到all-the-logs.log.1.gz并打开一个新文件all-the-logs.log。当all-the-logs.log再次达到10Mb时，all-the-logs.log.1.gz将重命名为all-the-logs.log.2.gz，依此类推。")]),t._v(" "),s("h4",{attrs:{id:"datefile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#datefile"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/dateFile.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("DateFile"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("将日志输出指定时间的日志文件中。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("必填")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("值")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("type")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("dateFile")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("filename")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("要写入日志的文件的路径。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("pattern")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("integer")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可选")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("（默认为.yyyy-MM-dd） - 用于确定何时滚动日志的模式。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("layout")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("object")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可选")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("（可选，默认为基础布局） - 请参阅"),s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/layouts.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("布局"),s("OutboundLink")],1)])])])]),t._v(" "),s("p",[t._v("pattern可以使用的占位符说明，不属于下列占位符格式，均会原样输出为文件名（注：不支持单个M、d、h、m）：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("占位符")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("yy")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("两位年份")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("yyyy")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("四位年份")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("MM")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("两位月份")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("dd")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("两位日期")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("hh")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("两位的小时数，按24小时制")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("mm")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("两位的分数数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("ss")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("两位的秒数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("SSS")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("三位的毫秒数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("O")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("时区，大写字母O，占位符输出结果为+0800")])])])]),t._v(" "),s("p",[t._v("假设当前是2014年6月20月15点，那么上面的配置最终将会记录到 "),s("code",[t._v("e:\\weblogs\\logs\\debug\\2014062015.txt")]),t._v("这个文件中。")]),t._v(" "),s("p",[t._v("示例：默认每日日志滚动")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("log4js.configure({\n  appenders: {\n    everything: { type: 'dateFile', filename: 'all-the-logs.log' }\n  },\n  categories: {\n    default: { appenders: [ 'everything' ], level: 'debug' }\n  }\n});\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("此示例将导致每天滚动文件。初始文件将是all-the-logs.log，每日备份all-the-logs.log.2017-04-30，等等。")]),t._v(" "),s("p",[t._v("示例：每小时日志滚动（和压缩备份）")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("log4js.configure({\n  appenders: {\n    everything: {\n        type: 'dateFile',\n        //文件名为= filename + pattern, 设置为alwaysIncludePattern：true\n        filename: 'all-the-logs',\n        pattern: '-yyyy-MM-dd-hh.log',\n        alwaysIncludePattern: true,\n        compress: true\n    }\n  },\n  categories: {\n    default: { appenders: [ 'everything' ], level: 'debug'}\n  }\n});\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])]),s("h4",{attrs:{id:"loglevelfilter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loglevelfilter"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/logLevelFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("logLevelFilter"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("根据事件级别过滤要记录的日志事件")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("必填")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("值")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("type")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("logLevelFilter")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("appender")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("要在同一配置中定义的要过滤的appender的名称")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("level")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("允许通过过滤器的最低事件级别")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("maxLevel")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可选")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("（默认为FATAL） - 允许通过过滤器的最大事件级别")])])])]),t._v(" "),s("p",[t._v("示例")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("log4js.configure({\n  appenders: {\n    everything: { type: 'file', filename: 'all-the-logs.log' },\n    emergencies: { type: 'file', filename: 'panic-now.log' },\n    just-errors: { type: 'logLevelFilter', appender: 'emergencies', level: 'error' }\n  },\n  categories: {\n    default: { appenders: ['just-errors', 'everything' ], level: 'debug' }\n  }\n});\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("h2",{attrs:{id:"api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),s("h3",{attrs:{id:"configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[t._v("#")]),t._v(" configuration")]),t._v(" "),s("p",[s("code",[t._v("log4js.configure(object || string)")]),t._v(" ：配置 log4js。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("加载配置的文件名。配置文件必须是 JSON 文件，并包含一个配置对象（参见下面的格式）")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("object")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("直接传递一个configuration对象")])])])]),t._v(" "),s("p",[t._v("在应用程序中首次 "),s("code",[t._v("require('log4js')")]),t._v(" 之后，应该立即进行配置。如果不调用 configure，log4js 将使用 LOG4JS_CONFIG （如果已定义）或默认配置。默认的配置定义了一个 appender，使用带颜色的布局将日志记录到 stdout，但也定义了默认日志级别是关闭的（即不会输出日志）。")]),t._v(" "),s("p",[t._v("如果您使用的是 cluster，那么在工作进程及主进程中都会调用 configure。工作进程将会为您的类别选择正确的级别，以及选择您定义的任何自定义级别。Appenders 只会在主进程被定义。因此，不存在多个进程试图写入同一个 appender 的危险。不需要特殊的配置来使用带有 cluster 的 Log4js （与以前的版本不同）。")]),t._v(" "),s("p",[t._v("configuration 对象必须定义至少一个 appender 和一个默认类别。如果配置无效，Log4js 将抛出异常。")]),t._v(" "),s("p",[t._v("configure 方法调用返回已配置的 Log4js 对象。")]),t._v(" "),s("h3",{attrs:{id:"configuration-对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration-对象"}},[t._v("#")]),t._v(" Configuration 对象")]),t._v(" "),s("h4",{attrs:{id:"appenders-object"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#appenders-object"}},[t._v("#")]),t._v(" appenders (object)")]),t._v(" "),s("p",[t._v("将命名 appender（string）映射到 appender definitions （object）的 map。appender definitions 必须有一个属性 type（string），其他属性依赖于 appender type。")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("log4js.configure({\n    appenders: [\n        {   \n            type: 'console' //控制台输出\n        },\n        {\n            type: 'file', //文件输出\n            filename: 'logs/access.log',\n            maxLogSize: 1024,\n            backups:3,\n            category: 'normal'\n        }\n    ]\n});\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("h4",{attrs:{id:"categories-object"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#categories-object"}},[t._v("#")]),t._v(" categories (object)")]),t._v(" "),s("p",[t._v("将命名 categories （string）映射到 category definitions（object）。你需要定义默认类别 category 用于所有与特定类别不匹配的日志事件。")]),t._v(" "),s("p",[t._v("类别定义 category definitions 有两个属性：")]),t._v(" "),s("ul",[s("li",[t._v("appenders (array of strings)：在这个 category 类别中使用的 appender 名称列表。一个 category 类别中至少要有一个 appender")]),t._v(" "),s("li",[t._v("level (string, 不区分大小写)：这个 category 类别将给 appender 发送最小的日志级别。例如：如果设置成“error”，那么 appender 将只会收到级别为‘error’, ‘fatal’, ‘mark’的日志事件，日志事件为‘info’, ‘warn’, ‘debug’, ‘trace’的将会被忽略。")])]),t._v(" "),s("h4",{attrs:{id:"pm2-可选-boolean"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pm2-可选-boolean"}},[t._v("#")]),t._v(" pm2 (可选, boolean)：")]),t._v(" "),s("p",[t._v("若您的 app 使用了 pm2，则这里必须设置为true，否则日志将不会工作（另外您还得下载 pm2-intercom作为 pm2模块: pm2 install pm2-intercom）")]),t._v(" "),s("h4",{attrs:{id:"pm2instancevar-string-可选"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pm2instancevar-string-可选"}},[t._v("#")]),t._v(" pm2InstanceVar (string, 可选)")]),t._v(" "),s("p",[t._v("(默认 ‘NODE_APP_INSTANCE’)：如果您使用pm2并更改了默认名称，则这里必须要设置。")]),t._v(" "),s("h4",{attrs:{id:"disableclustering-boolean-可选"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#disableclustering-boolean-可选"}},[t._v("#")]),t._v(" disableClustering (boolean, 可选)")]),t._v(" "),s("p",[t._v("true：使用的 log4js 忽略集群环境（clustered environments）或者你在 pm2 日志中遇到了麻烦。每一个工作进程都将进行自己的日志记录。请小心使用这里如果你要把日志记录输出到文件。")]),t._v(" "),s("h3",{attrs:{id:"loggers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loggers"}},[t._v("#")]),t._v(" Loggers")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("log4js.getLogger([category])\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h2",{attrs:{id:"使用示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[t._v("#")]),t._v(" 使用示例")]),t._v(" "),s("h3",{attrs:{id:"结合express使用-网络请求时的日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#结合express使用-网络请求时的日志"}},[t._v("#")]),t._v(" 结合Express使用——网络请求时的日志")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" log4js "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'log4js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlog4js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    appenders"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"console"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        access_file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./access.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            maxLogSize"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            backups"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            category"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'access'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    categories"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            appenders"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"console"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            level"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        access"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            appenders"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"access_file"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            level"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'info'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    replaceConsole"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" logger "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" log4js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'access'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("log4js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connectLogger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" level"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'auto'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" format"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':method :url :status :response-time ms'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nlogger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loglog"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlogger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"infoinfo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlogger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"errorerror"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"测试"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"错误"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Server Running on http://localhost:3000"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br")])]),s("h3",{attrs:{id:"需求实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#需求实例"}},[t._v("#")]),t._v(" 需求实例")]),t._v(" "),s("ol",[s("li",[t._v("每天生成一个日志文件,放在/logs目录下，名字如2017-09-23.log；")]),t._v(" "),s("li",[t._v("单独将log4js配置在一个文件中，外界不需要每次配置；")]),t._v(" "),s("li",[t._v("记录客户端请求的HTTP状态码、URL、方法。")]),t._v(" "),s("li",[t._v("终端显示所有日志信息，日志文件只记录WARN以及以上级别的信息。")])]),t._v(" "),s("h3",{attrs:{id:"实际使用中的其他细节的简略概要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实际使用中的其他细节的简略概要"}},[t._v("#")]),t._v(" 实际使用中的其他细节的简略概要")]),t._v(" "),s("p",[t._v("配置文件我配置了两套,分别是")]),t._v(" "),s("ul",[s("li",[t._v("开发调试环境的,所有type都是console")]),t._v(" "),s("li",[t._v("线上环境配置,type、路径和日志级别有所改动")])]),t._v(" "),s("h2",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.jianshu.com/p/9604d08db899",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.jianshu.com/p/9604d08db899"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.cnblogs.com/duhuo/p/5176154.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.cnblogs.com/duhuo/p/5176154.html"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/m0_37263637/article/details/80328505",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.csdn.net/m0_37263637/article/details/80328505"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("other")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.cnblogs.com/yangzhx/p/4711311.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.cnblogs.com/yangzhx/p/4711311.html"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/chenyufeng1991/article/details/54809927",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.csdn.net/chenyufeng1991/article/details/54809927"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/xjtroddy/article/details/51697077",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.csdn.net/xjtroddy/article/details/51697077"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/cdnight/article/details/50857268",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.csdn.net/cdnight/article/details/50857268"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/22110802",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://zhuanlan.zhihu.com/p/22110802"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=n.exports}}]);